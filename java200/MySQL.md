> ## MySql

**164.数据库的三范式是什么？**
```
第一范式：强调的是列的原子性，就是列不能够再分成其他几列；

第二范式：一是表必须有一个主键；二是没有包含在主键中的列必须完全依赖于主键，而不能只依赖主键的一部分；

第三范式：任何非主属性不依赖于其他非主属性。
原文链接：https://blog.csdn.net/weixin_45022376/article/details/104551142
```

**165.一张自增表里面总共有 7 条数据，删除了最后 2 条数据，重启 mysql 数据库，又插入了一条数据，此时 id 是几？**
```
一般情况下，我们创建的表的类型是InnoDB，如果新增一条记录（不重启mysql的情况下），这条记录的id是8；但是如果重启（文中提到的）MySQL的话，这条记录的ID是6。因为InnoDB表只把自增主键的最大ID记录到内存中，所以重启数据库或者对表OPTIMIZE操作，都会使最大ID丢失。

但是，如果我们使用表的类型是MylSAM，那么这条记录的ID就是8。因为MylSAM表会把自增主键的最大ID记录到数据文件里面，重启MYSQL后，自增主键的最大ID也不会丢失。

注：如果在这7条记录里面删除的是中间的几个记录（比如删除的是3,4两条记录），重启MySQL数据库后，insert一条记录后，ID都是8。因为内存或者数据库文件存储都是自增主键最大ID
```

**166.如何获取当前数据库版本？**
```
select version();
```

**167.说一下 ACID 是什么？**
```

Atomicity（原子性）：一个事务（transaction）中的所有操作，或者全部完成，或者全部不完成，
不会结束在中间某个环节。事务在执行过程中发生错误，会被恢复（Rollback）到事务开始前的状态，
就像这个事务从来没有执行过一样。即，事务不可分割、不可约简。
 
Consistency（一致性）：在事务开始之前和事务结束以后，数据库的完整性没有被破坏。
这表示写入的资料必须完全符合所有的预设约束、触发器、级联回滚等。
 
Isolation（隔离性）：数据库允许多个并发事务同时对其数据进行读写和修改的能力，
隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。事务隔离分为不同级别，
包括读未提交（Read uncommitted）、读提交（read committed）、
可重复读（repeatable read）和串行化（Serializable）。
 
Durability（持久性）：事务处理结束后，对数据的修改就是永久的，即便系统故障也不会丢失。
```

**168.char 和 varchar 的区别是什么？**
```
1. char类型的长度是固定的，varchar的长度是可变的。

   这就表示，存储字符串'abc'，使用char(10)，表示存储的字符将占10个字节（包括7个空字符），使用varchar2(10),，则表示只占3个字节，10是最大值，当存储的字符小于10时，按照实际的长度存储。超出长度都自动截取。

2.char类型的效率比varchar的效率稍高
char最多可以存放255个字符
varchar的最大长度为65535个字节，varchar可存放的字符数跟编码有关
字符类型若为gbk，每个字符最多占2个字节，最大长度不能超过32766个字符
字符类型若为utf8，每个字符最多占3个字节，最大长度不能超过21845个字符
```

**169.float 和 double 的区别是什么？**
```
float数值类型用于表示单精度浮点数值，而double数值类型用于表示双精度浮点数值，float和double都是浮点型，而decimal是定点型；

MySQL 浮点型和定点型可以用类型名称后加（M，D）来表示，M表示该值的总共长度，D表示小数点后面的长度，M和D又称为精度和标度，如float(7,4)的 可显示为-999.9999，MySQL保存值时进行四舍五入，如果插入999.00009，则结果为999.0001。

FLOAT和DOUBLE在不指 定精度时，默认会按照实际的精度来显示，而DECIMAL在不指定精度时，默认整数为10，小数为0。

注意float与double数据类型储存的是近似值，而decimal是字符串
```

**170.mysql 的内连接、左连接、右连接有什么区别？**
```
1.内连接,显示两个表中有联系的所有数据;

2.左链接,以左表为参照,显示所有数据,右表中没有则以null显示

3.右链接,以右表为参照显示数据，,左表中没有则以null显示
```

**171.mysql 索引是怎么实现的？**

**172.怎么验证 mysql 的索引是否满足需求？**
```
使用方法，在select语句前加上explain就可以了：

EXPLAIN SELECT surname,first_name form a,b WHERE a.id=b.id
EXPLAIN列的解释：

table：显示这一行的数据是关于哪张表的。

type：这是重要的列，显示连接使用了何种类型。从最好到最差的连接类型为const、eq_reg、ref、range、index和ALL。

possible_keys：显示可能应用在这张表中的索引。如果为空，没有可能的索引。可以为相关的域从WHERE语句中选择一个合适的语句。

key： 实际使用的索引。如果为NULL，则没有使用索引。很少的情况下，MySQL会选择优化不足的索引。这种情况下，可以在SELECT语句中使用USE INDEX（indexname）来强制使用一个索引或者用IGNORE INDEX（indexname）来强制MySQL忽略索引。

key_len：使用的索引的长度。在不损失精确性的情况下，长度越短越好。

ref：显示索引的哪一列被使用了，如果可能的话，是一个常数。

rows：MySQL认为必须检查的用来返回请求数据的行数。

Extra：关于MySQL如何解析查询的额外信息。
```

**173.说一下数据库的事务隔离？**
```
https://blog.csdn.net/fuzhongmin05/article/details/91126936
```

**174.说一下 mysql 常用的引擎？**
```
MySQL常用的四种引擎的介绍
（1）：MyISAM存储引擎：不支持事务、也不支持外键，优势是访问速度快，对事务完整性没有 要求或者以select，insert为主的应用基本上可以用这个引擎来创建表
支持3种不同的存储格式，分别是：静态表；动态表；压缩表

静态表：表中的字段都是非变长字段，这样每个记录都是固定长度的，优点存储非常迅速，容易缓存，出现故障容易恢复；缺点是占用的空间通常比动态表多（因为存储时会按照列的宽度定义补足空格）ps：在取数据的时候，默认会把字段后面的空格去掉，如果不注意会把数据本身带的空格也会忽略。

动态表：记录不是固定长度的，这样存储的优点是占用的空间相对较少；缺点：频繁的更新、删除数据容易产生碎片，需要定期执行OPTIMIZE TABLE或者myisamchk-r命令来改善性能
压缩表：因为每个记录是被单独压缩的，所以只有非常小的访问开支

（2）InnoDB存储引擎*
该存储引擎提供了具有提交、回滚和崩溃恢复能力的事务安全。但是对比MyISAM引擎，写的处理效率会差一些，并且会占用更多的磁盘空间以保留数据和索引。 
InnoDB存储引擎的特点：支持自动增长列，支持外键约束

(3)：MEMORY存储引擎
Memory存储引擎使用存在于内存中的内容来创建表。每个memory表只实际对应一个磁盘文件，格式是.frm。memory类型的表访问非常的快，因为它的数据是放在内存中的，并且默认使用HASH索引，但是一旦服务关闭，表中的数据就会丢失掉。 
MEMORY存储引擎的表可以选择使用BTREE索引或者HASH索引，两种不同类型的索引有其不同的使用范围

Hash索引优点： 
Hash 索引结构的特殊性，其检索效率非常高，索引的检索可以一次定位，不像B-Tree 索引需要从根节点到枝节点，最后才能访问到页节点这样多次的IO访问，所以 Hash 索引的查询效率要远高于 B-Tree 索引。 
Hash索引缺点： 那么不精确查找呢，也很明显，因为hash算法是基于等值计算的，所以对于“like”等范围查找hash索引无效，不支持；
Memory类型的存储引擎主要用于哪些内容变化不频繁的代码表，或者作为统计操作的中间结果表，便于高效地对中间结果进行分析并得到最终的统计结果，。对存储引擎为memory的表进行更新操作要谨慎，因为数据并没有实际写入到磁盘中，所以一定要对下次重新启动服务后如何获得这些修改后的数据有所考虑。

（4）MERGE存储引擎
Merge存储引擎是一组MyISAM表的组合，这些MyISAM表必须结构完全相同，merge表本身并没有数据，对merge类型的表可以进行查询，更新，删除操作，这些操作实际上是对内部的MyISAM表进行的。
```

175.说一下 mysql 的行锁和表锁？

176.说一下乐观锁和悲观锁？

**177.mysql 问题排查都有哪些手段？**
```
使用 show processlist 命令查看当前所有连接信息。
使用 explain 命令查询 SQL 语句执行计划。
开启慢查询日志，查看慢查询的 SQL。
```

**178.如何做 mysql 的性能优化？**
```
为搜索字段创建索引。
避免使用 select *，列出需要查询的字段。
垂直分割分表。
选择正确的存储引擎。
```