> # 列存储

- 联机事务处理 `OLTP`(on-line transaction processing) 是传统关系型数据库的主要应用，用来执行一些基本的、日常的事务处理，比如数据库记录的增、删、改、查等等。
- 联机分析处理 `OLAP`(On-Line Analytical Processing) 则是分布式数据库的主要应用，它对实时性要求不高，但处理的数据量大，通常应用于复杂的动态报表系统上。

> ### 与行存储对比

1. 在`数据写入`上的对比

- 行存储的写入是`一次完成`。如果这种写入建立在操作系统的文件系统上，可以保证写入过程的成功或者失败，数据的完整性因此可以确定。
- 列存储由于需要把一行记录拆分成单列保存，写入次数明显比行存储多（意味着磁头调度次数多，而磁头调度是需要时间的，一般在1ms~10ms)，再加上磁头需要在盘片上移动和定位花费的时间，实际时间消耗会更大。所以，`行存储在写入上占有很大的优势`。
- 还有数据修改,这实际也是一次写入过程。不同的是，数据修改是对磁盘上的记录做删除标记。行存储是在指定位置写入一次，列存储是将磁盘定位到`多个列上分别写入`，这个过程仍是行存储的列数倍。所以，`数据修改也是以行存储占优`。

2. 在`数据读取`上的对比

- 数据读取时，行存储通常将`一行数据完全读出`，如果只需要其中几列数据的情况，就会存在冗余列，出于缩短处理时间的考量，消除冗余列的过程通常是在内存中进行的。
- 列存储每次读取的数据是集合的一段或者全部，不存在`冗余性`问题。
- 两种存储的数据分布。由于列存储的每一列数据类型是`同质的`，不存在二义性问题。比如说某列数据类型为整型(int)，那么它的数据集合一定是整型数据。这种情况使数据解析变得十分容易。相比之下，`行存储则要复杂得多`，因为在一行记录中保存了`多种类型`的数据，数据解析需要在多种数据类型之间频繁转换，这个操作很消耗CPU，增加了解析的时间。所以，列存储的解析过程更有利于分析大数据。

> ### 优缺点

1. 行存储的写入是`一次性完成`，消耗的时间比列存储少，并且能够保证数据的完整性，缺点是数据读取过程中会产生冗余数据，如果只有少量数据，此影响可以忽略;数量大可能会影响到数据的处理效率。

2. 列存储在写入效率、保证数据完整性上都不如行存储，它的优势是在读取过程，`不会产生冗余数据`，这对数据完整性要求不高的大数据处理领域，比如互联网，犹为重要。查询过程中，可针对各列的运算并发执行(SMP)，***在内存中聚合完整记录集，***可能降低查询响应时间；可在数据列中高效查找数据，`无需维护索引`(任何列都能作为索引)，查询过程中能够尽量减少无关IO，`避免全表扫描`；因为各列独立存储，且数据类型已知，可以针对该列的数据类型、数据量大小等因素`动态选择压缩算法`，以提高物理存储利用率；如果某一行的某一列没有数据，那在列存储时，就可以不存储该列的值，这将比行式存储更节省空间。